{% extends "utilisateurs/base.html" %}

{% block title %}Inscrire un élève - IMJF{% endblock %}

{% block head_extra %}
    <style>
        .transition-all { transition: all 0.3s ease; }
    </style>
{% endblock %}

{% block body_class %}bg-gray-50 min-h-screen p-6{% endblock %}

{% block content %}
    <div class="max-w-2xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-800 mb-8">Ajouter un élève</h1>

        <div class="bg-white rounded-xl shadow-md p-6">
            <form id="inscription-form">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Nom -->
                    <div>
                        <label for="nom" class="block text-sm font-medium text-gray-700 mb-1">Nom complet</label>
                        <input type="text" id="nom" class="w-full px-4 py-2 border border-gray-300 rounded-lg 
                               focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all" required>
                    </div>

                    <!-- Date de naissance -->
                    <div>
                        <label for="date-naissance" class="block text-sm font-medium text-gray-700 mb-1">Date de naissance</label>
                        <input type="date" id="date-naissance" class="w-full px-4 py-2 border border-gray-300 rounded-lg 
                               focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all" required>
                    </div>

                    <!-- Sexe -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Sexe</label>
                        <div class="flex space-x-4">
                            <label class="inline-flex items-center">
                                <input type="radio" name="sexe" value="H" class="text-amber-500 focus:ring-amber-500" required>
                                <span class="ml-2">Homme</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="sexe" value="F" class="text-amber-500 focus:ring-amber-500">
                                <span class="ml-2">Femme</span>
                            </label>
                        </div>
                    </div>

                    <!-- Classe -->
                    <div>
                        <label for="classe" class="block text-sm font-medium text-gray-700 mb-1">Classe</label>
                        <select id="classe" class="w-full px-4 py-2 border border-gray-300 rounded-lg 
                                focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all" required>
                            <option value="">Sélectionnez une classe</option>
                            <option value="7eme">7eme</option>
                            <option value="8eme">8eme</option>
                            <option value="9eme">9eme</option>
                            <option value="NSI">NSI</option>
                        </select>
                    </div>

                    <!-- Adresse -->
                    <div class="md:col-span-2">
                        <label for="adresse" class="block text-sm font-medium text-gray-700 mb-1">Adresse</label>
                        <textarea id="adresse" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg 
                                  focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all" required></textarea>
                    </div>

                    <!-- Téléphone -->
                    <div>
                        <label for="telephone" class="block text-sm font-medium text-gray-700 mb-1">Téléphone</label>
                        <input type="tel" id="telephone" class="w-full px-4 py-2 border border-gray-300 rounded-lg 
                               focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all" required>
                    </div>
                </div>

                <!-- Boutons -->
                <div class="flex justify-end space-x-4 mt-8">
                    <a href="{% url 'eleves:eleves' %}" 
                       class="bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-6 rounded-lg transition-all transform hover:scale-105">
                       Annuler
                    </a>
                    <button type="submit" 
                            class="bg-amber-500 hover:bg-amber-600 text-white font-medium py-2 px-6 rounded-lg transition-all transform hover:scale-105">
                        Enregistrer
                    </button>
                </div>
            </form>
        </div>
    </div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('inscription-form').addEventListener('submit', function(e) {
    e.preventDefault();

    const formData = {
        nom: document.getElementById('nom').value,
        dateNaissance: document.getElementById('date-naissance').value,
        sexe: (document.querySelector('input[name="sexe"]:checked') || {}).value || null,
        classe: document.getElementById('classe').value,
        adresse: document.getElementById('adresse').value,
        telephone: document.getElementById('telephone').value
    };

    let eleves = JSON.parse(localStorage.getItem('eleves')) || [];
    const nouvelEleve = {
        id: eleves.length + 1,
        numero: (eleves.length + 1).toString().padStart(3, '0'),
        nom: formData.nom,
        classe: formData.classe,
        statut: 'actif',
        details: formData
    };

    eleves.push(nouvelEleve);
    localStorage.setItem('eleves', JSON.stringify(eleves));
    alert('Élève inscrit avec succès!');
    window.location.href = '{% url "eleves:eleves" %}';
});
</script>
{% endblock %}
